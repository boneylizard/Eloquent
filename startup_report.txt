===== Launcher Output =====
üìå Using ports: backend=8000, secondary=8001, tts=8002
üåç Multiple Network IPs detected: 192.168.4.30, 192.168.56.1, 100.82.152.186
üëâ Selected 192.168.4.30 for configuration
üåç Local Network IP: 192.168.4.30 (Use this on mobile: http://192.168.4.30:5173)
üìù Wrote port config to C:\Users\bpfit\LiangLocal\frontend\public\ports.json
Starting model service on port 5555...
‚úÖ Model service started successfully
Detected 1 NVIDIA GPU(s):
  GPU 0: NVIDIA GeForce RTX 3090
Found 1 NVIDIA GPU. Starting backend and TTS service on GPU 0.
--- Starting Server Process for GPU 0 on Port 8000 ---
--- Using Python executable: C:\Users\bpfit\LiangLocal\venv\Scripts\python.exe ---
--- Environment 'CUDA_VISIBLE_DEVICES' set to '0' ---
--- Command: C:\Users\bpfit\LiangLocal\venv\Scripts\python.exe -m uvicorn backend.app.main:app --host 0.0.0.0 --port 8000 --log-level info --ws-ping-interval 300 ---
‚úÖ Backend process started (PID: 31132)
‚úÖ Main backend started on port 8000 using GPU 0
--- Starting TTS Service on Port 8002 ---
--- Command: C:\Users\bpfit\LiangLocal\venv\Scripts\python.exe C:\Users\bpfit\LiangLocal\launch_tts.py ---
‚úÖ TTS service launched (PID: 49660)
‚úÖ TTS service launched on port 8002
Browser launched at http://localhost:5173/

===== Backend Startup Log =====
2026-01-20 14:54:16,421 - INFO - Static directory ensured: C:\Users\bpfit\LiangLocal\backend\app\static
2026-01-20 14:54:16,422 - INFO - Generated images directory ensured: C:\Users\bpfit\LiangLocal\backend\app\static\generated_images
2026-01-20 14:54:16,423 - INFO - Attempting to mount static directory: C:\Users\bpfit\LiangLocal\backend\app\static
2026-01-20 14:54:16,467 - INFO - üîó OpenAI-compatible API endpoints available at /v1/chat/completions and /v1/models
2026-01-20 14:54:16,467 - INFO - Application lifespan startup...
2026-01-20 14:54:16,468 - INFO - üîç Looking for settings at: C:\Users\bpfit\.LiangLocal\settings.json
2026-01-20 14:54:16,468 - INFO - üîç Settings file contents: {'modelDirectory': 'F:\\Models', 'activeProfileId': 'profile_1768685990553_6r36s9l', 'gpuUsageMode': 'split_services', 'sdModelDirectory': 'C:\\stable-diffusion-webui\\models\\Stable-diffusion', 'adetailerModelDirectory': 'F:\\Models', 'tts_speed_mode': 'ultra_fast', 'customApiEndpoints': [{'id': 'endpoint-1751699328404', 'name': 'Chub', 'url': 'https://mars.chub.ai/chub/asha/v1', 'apiKey': 'CHK-8SGBYAPCWIDB51G9B8J434C2YB3FEYIZDYSR9CAL9409829', 'enabled': True, 'contextLength': 8192, 'model': '', 'context_window': '8192'}], 'useOpenAIAPI': True, 'voice_cache': [{'voice_id': 'Lizzo.m4a', 'engine': 'chatterbox'}, {'voice_id': 'Nevaeh.m4a', 'engine': 'chatterbox'}, {'voice_id': 'HillaryDuff.wav', 'engine': 'chatterbox'}, {'voice_id': 'Candace.m4a', 'engine': 'chatterbox'}, {'voice_id': 'Laura_Barron_lopez.wav', 'engine': 'chatterbox'}], 'tensor_split': [0.6, 0.4], 'directProfileInjection': False, 'upscaler_model_directory': 'C:\\stable-diffusion-webui\\models\\ESRGAN', 'temperature': 0.7, 'max_tokens': -1, 'top_p': 0.9, 'top_k': 50, 'repetition_penalty': 1.1, 'use_rag': False, 'selectedDocuments': [], 'contextLength': 8192, 'useMemory': False, 'useMemoryAgent': False, 'useLore': False, 'useLoreAgent': False, 'useLoreAgentForMemory': False, 'useLoreAgentForMemoryRetrieval': False, 'useLoreAgentForMemoryObservation': False, 'sttEnabled': True, 'streamResponses': True, 'sttEngine': 'parakeet', 'ttsVoice': 'Candace.m4a', 'ttsSpeed': 1, 'ttsPitch': 0, 'ttsAutoPlay': True, 'userAvatarSize': None, 'characterAvatarSize': 160, 'admin_password': '', 'contextPruningThreshold': 0.9, 'contextPruningTarget': 0.7, 'enableAutoSummarization': False, 'conversationSummary': '', 'singleGpuMode': True, 'memoryIntentText': '', 'frequencyPenalty': 0.5, 'presencePenalty': 0.4, 'antiRepetitionMode': True, 'detectRepeatedPhrases': True, 'ttsEngine': 'chatterbox', 'ttsExaggeration': 0.7, 'ttsCfg': 0.4, 'ttsSpeedMode': 'standard', 'sdSteps': 20, 'sdSampler': 'Euler a', 'sdCfgScale': 7, 'imageEngine': 'EloDiffusion', 'enableSdStatus': True, 'ttsEnabled': True, 'upscalerModelDirectory': 'C:\\stable-diffusion-webui\\models\\ESRGAN'}
2026-01-20 14:54:16,468 - INFO - Detected 1 GPUs. Single GPU mode: True (settings override: True)
2026-01-20 14:54:16,468 - INFO - üîç Using user GPU usage mode preference: split_services
2026-01-20 14:54:16,468 - INFO - SD model directory set to: C:\stable-diffusion-webui\models\Stable-diffusion
2026-01-20 14:54:16,468 - INFO - üîç About to create ModelManager with gpu_usage_mode: split_services
2026-01-20 14:54:16,468 - INFO - Lifespan: Running on Port 8000, Default GPU 0, GPU Mode: split_services
2026-01-20 14:54:16,469 - INFO - ‚úÖ [Split Mode] Set CUDA_VISIBLE_DEVICES to 0
2026-01-20 14:54:16,469 - INFO - pynvml detected 1 GPUs.
2026-01-20 14:54:16,485 - INFO - Found 1 GPUs via pynvml: NVIDIA GeForce RTX 3090
2026-01-20 14:54:16,485 - INFO - Default GPU ID set to: 0
2026-01-20 14:54:16,485 - INFO - GPU usage mode: split_services
2026-01-20 14:54:16,485 - INFO - Default GPU ID set to: 0
2026-01-20 14:54:16,485 - INFO - Server starting on port 8000 with default GPU 0
2026-01-20 14:54:16,485 - INFO - ‚úÖ Devstral service initialized
2026-01-20 14:54:16,486 - INFO - Found 0 ADetailer models: []
2026-01-20 14:54:16,486 - INFO - SDManager initialized with ADetailer support
2026-01-20 14:54:16,486 - INFO - SD Manager initialized
2026-01-20 14:54:16,486 - INFO - üîó Checking TTS service availability...
2026-01-20 14:54:18,972 - INFO - HTTP Request: GET http://localhost:8002/health "HTTP/1.1 200 OK"
2026-01-20 14:54:18,972 - INFO - ‚úÖ TTS service is running: {'status': 'healthy', 'service': 'tts_backend', 'initialized': True, 'models': {'chatterbox': False}}
2026-01-20 14:54:18,973 - INFO - üìå Main backend on port 8000 - TTS runs separately on port 8002
2026-01-20 14:54:18,973 - INFO - ‚úÖ TTS client initialized for forwarding to TTS service on port 8002
2026-01-20 14:54:18,973 - INFO - RAG system initialization skipped or failed
2026-01-20 14:54:18,973 - INFO - Initializing Forensic Linguistics Service...
2026-01-20 14:54:18,973 - INFO - ‚úÖ Forensic Linguistics Service initialized (no embedding model loaded - use Settings to load manually)
2026-01-20 14:54:18,975 - WARNING - No profile found for ID: profile_1768685990553_6r36s9l
2026-01-20 14:54:18,976 - INFO - Active user profile: profile_1768685990553_6r36s9l

===== TTS Startup Log =====
2026-01-20 14:53:54,527 - INFO - üöÄ Starting TTS Backend Service...
2026-01-20 14:53:54,527 - INFO - üìå TTS Backend ready - CUDA/model loading deferred
2026-01-20 14:53:54,527 - INFO - üìå Chatterbox will load on first TTS request
2026-01-20 14:53:54,527 - INFO - üìå This prevents CUDA conflicts with Stable Diffusion (ggml)
2026-01-20 14:53:54,527 - INFO - üéâ TTS Backend Service ready!
