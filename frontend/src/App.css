@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /* ChatGPT Theme - Light Mode (Actual colors from chatgpt.com) */
    --background: #FFFFFF;
    /* Pure white */
    --foreground: #0D0D0D;
    /* Near-black text - ChatGPT's actual text color */
    --card: #F9F9F9;
    /* Very subtle grey for cards */
    --card-foreground: #0D0D0D;
    --popover: #FFFFFF;
    --popover-foreground: #0D0D0D;

    --primary: #10A37F;
    /* ChatGPT brand green (from their branding) */
    --primary-foreground: #FFFFFF;

    /* User Bubble - semi-transparent grey */
    --secondary: rgba(233, 233, 233, 0.5);
    /* Actual extracted color - translucent grey */
    --secondary-foreground: #0D0D0D;

    /* Bot Bubble - ChatGPT doesn't use bubbles */
    --muted: #FFFFFF;
    /* Same as background */
    --muted-foreground: #0D0D0D;

    --accent: rgba(0, 0, 0, 0.06);
    /* Subtle grey for sidebar items */
    --accent-foreground: #0D0D0D;
    --destructive: #EF4444;
    --destructive-foreground: #FFFFFF;
    --border: rgba(13, 13, 13, 0.05);
    /* Very subtle border */
    --input: #FFFFFF;
    --ring: #10A37F;
    --radius: 1.125rem;
    /* 18px - ChatGPT's message bubble radius */
    --shadow: 0 1px 2px rgba(0, 0, 0, 0.05);

    --primary-gradient: linear-gradient(135deg, #19C37D, #10A37F);

    /* Extended Tokens */
    --input-bg: transparent;
    --focus-ring: 2px solid var(--ring);

    /* Markdown emphasis colors (light defaults) */
    --md-body-color-default: #111827;
    --md-bold-color-default: #0b0f14;
    --md-italic-color-default: #4b5563;
    --md-quote-color-default: #2563eb;
    --md-quote-border-default: #cbd5e1;
    --md-h1-color-default: var(--foreground);
    --md-h2-color-default: var(--foreground);
    --md-h3-color-default: var(--foreground);
    --md-h1-font-default: var(--font-heading);
    --md-h2-font-default: var(--font-heading);
    --md-h3-font-default: var(--font-heading);

    --md-body-color: #111827;
    --md-bold-color: #0b0f14;
    --md-italic-color: #4b5563;
    --md-quote-color: #2563eb;
    --md-quote-border: #cbd5e1;
    --md-h1-color: var(--foreground);
    --md-h2-color: var(--foreground);
    --md-h3-color: var(--foreground);
    --md-h1-font: var(--font-heading);
    --md-h2-font: var(--font-heading);
    --md-h3-font: var(--font-heading);

    /* Global Font Family Variable (optional to override per theme) */
    --font-heading: 'Poppins', sans-serif;
    --font-body: 'Inter', sans-serif;
    --font-mono: 'JetBrains Mono', monospace;

    /* Election Tracker (theme-aware) */
    --bg-primary: var(--background);
    --text-primary: var(--foreground);
    --text-secondary: var(--muted-foreground);
    --border-color: var(--border);
    --accent-primary: var(--primary);
    --accent-secondary: var(--primary);
    --bg-secondary: var(--card);
    --bg-tertiary: var(--muted);

    /* Chess UI tokens */
    --chess-board-light: #f0d9b5;
    --chess-board-dark: #b58863;
    --chess-panel-bg: var(--card);
    --chess-panel-border: rgba(13, 13, 13, 0.1);
    --chess-panel-shadow: 0 12px 24px rgba(0, 0, 0, 0.08);
    --chess-eval-track: rgba(13, 13, 13, 0.08);
    --chess-eval-dark: rgba(13, 13, 13, 0.28);
    --chess-eval-light: var(--primary);
  }

  /* --- THEMES --- */

  /* Dark Mode (Standard) */
  [data-theme="dark"] {
    --background: #020617;
    /* Slate 950 */
    --foreground: #ffffff;
    /* FORCE WHITE TEXT */
    --card: #0f172a;
    /* Slate 900 */
    --card-foreground: #f8fafc;
    --popover: #0f172a;
    --popover-foreground: #f8fafc;
    --primary: #f8fafc;
    --primary-foreground: #020617;
    --secondary: #1e293b;
    /* Slate 800 (User Bubble) */
    --secondary-foreground: #ffffff;
    /* PURE WHITE */
    --muted: #0f172a;
    /* Slate 900 (Bot Bubble - Darker/Receded) */
    --muted-foreground: #ffffff;
    /* PURE WHITE for Bot text */
    --accent: #1e293b;
    --accent-foreground: #f8fafc;
    --destructive: #7f1d1d;
    --destructive-foreground: #f8fafc;
    --border: #1e293b;
    --input: #1e293b;
    --ring: #cbd5e1;
    /* Slate 300 */

    /* Extended Tokens - Dark Mode Overrides */
    --input-bg: var(--input);
    --button-text: #ffffff;

    /* Markdown emphasis colors (dark defaults) */
    --md-body-color-default: #e6edf3;
    --md-bold-color-default: #ffffff;
    --md-italic-color-default: #a7b0c0;
    --md-quote-color-default: #9ec5ff;
    --md-quote-border-default: #3b4a64;

    --md-body-color: #e6edf3;
    --md-bold-color: #ffffff;
    --md-italic-color: #a7b0c0;
    --md-quote-color: #9ec5ff;
    --md-quote-border: #3b4a64;

    --bg-primary: var(--background);
    --text-primary: var(--foreground);
    --text-secondary: var(--muted-foreground);
    --border-color: var(--border);
    --accent-primary: var(--primary);
    --accent-secondary: var(--primary);
    --bg-secondary: var(--card);
    --bg-tertiary: var(--muted);
  }

  /* WhatsApp Theme (Authentic Dark) */
  [data-theme="whatsapp"] {
    --background: #0b141a;
    /* WA Dark Bg */
    --foreground: #e9edef;
    /* WA Text */
    --card: #1f2c34;
    /* WA Panels */
    --card-foreground: #e9edef;
    --popover: #1f2c34;
    --popover-foreground: #e9edef;
    --primary: #00a884;
    /* WA Teal */
    --primary-foreground: #ffffff;
    --secondary: #005c4b;
    /* Outgoing Bubble Green */
    --secondary-foreground: #e9edef;
    --muted: #202c33;
    /* Incoming Bubble */
    --muted-foreground: #e9edef;
    /* WA Primary Text for Bot */
    --accent: #202c33;
    --accent-foreground: #e9edef;
    --destructive: #ef4444;
    --destructive-foreground: #ffffff;
    --border: #202c33;
    /* Seamless borders */
    --input: #2a3942;
    /* Search Bar */
    --ring: #00a884;
    --radius: 1rem;
    /* Rounder bubbles */
    --shadow: none;
    /* Flat aesthetic */

    /* Markdown emphasis colors */
    --md-body-color-default: #e9edef;
    --md-bold-color-default: #ffffff;
    --md-italic-color-default: #bfc8cc;
    --md-quote-color-default: #9de0d6;
    --md-quote-border-default: #2d3b43;

    --md-body-color: #e9edef;
    --md-bold-color: #ffffff;
    --md-italic-color: #bfc8cc;
    --md-quote-color: #9de0d6;
    --md-quote-border: #2d3b43;

    --bg-primary: var(--background);
    --text-primary: var(--foreground);
    --text-secondary: var(--muted-foreground);
    --border-color: var(--border);
    --accent-primary: var(--primary);
    --accent-secondary: var(--primary);
    --bg-secondary: var(--card);
    --bg-tertiary: var(--muted);
  }

  /* Messenger Theme (Premium Dark + Gradient) */
  [data-theme="messenger"] {
    --background: #000000;
    --foreground: #ffffff;
    /* Pure White Text */
    --card: #000000;
    --card-foreground: #ffffff;
    --popover: #1f1f1f;
    --popover-foreground: #ffffff;

    /* Brand Color: Facebook Messenger Blue #0084FF */
    --primary: #0084FF;
    --primary-foreground: #ffffff;

    /* Bubbles & UI Elements */
    --secondary: #0084FF;
    /* Use primary for outgoing bubbles (Blue) */
    --secondary-foreground: #ffffff;

    --muted: #262626;
    /* Dark Gray Bubble (Incoming) */
    --muted-foreground: #e4e6eb;
    /* Lighter text for incoming */

    --accent: #262626;
    --accent-foreground: #ffffff;
    --destructive: #ff3b30;
    --destructive-foreground: #ffffff;

    --border: #262626;
    --input: #1a1a1a;
    /* Lighter than bg, distinct input area */
    --ring: #0084FF;
    --radius: 1.5rem;
    /* Full Pill shapes */
    --shadow: 0 8px 24px rgba(0, 0, 0, 0.5);
    /* Deep glossy shadow */

    /* Special Gradient Token */
    --primary-gradient: linear-gradient(to right, #00C6FF, #0072FF);

    /* Markdown emphasis colors */
    --md-body-color-default: #e4e6eb;
    --md-bold-color-default: #ffffff;
    --md-italic-color-default: #cbd5e1;
    --md-quote-color-default: #93c5fd;
    --md-quote-border-default: #2f3336;

    --md-body-color: #e4e6eb;
    --md-bold-color: #ffffff;
    --md-italic-color: #cbd5e1;
    --md-quote-color: #93c5fd;
    --md-quote-border: #2f3336;

    --bg-primary: var(--background);
    --text-primary: var(--foreground);
    --text-secondary: var(--muted-foreground);
    --border-color: var(--border);
    --accent-primary: var(--primary);
    --accent-secondary: var(--primary);
    --bg-secondary: var(--card);
    --bg-tertiary: var(--muted);
  }

  /* Cyberpunk Theme (Neon, High Contrast) */
  [data-theme="cyberpunk"] {
    --background: #000b1e;
    /* Deep Navy/Black */
    --foreground: #ffffff;
    /* Force White for readability */
    --card: #051628;
    /* Slightly lighter navy */
    --card-foreground: #ffffff;
    --popover: #051628;
    --popover-foreground: #ffffff;
    --primary: #fcee0a;
    /* Neon Yellow */
    --primary-foreground: #000000;
    --secondary: #00f0ff;
    /* Neon Blue */
    --secondary-foreground: #000000;
    /* Black text on Neon Blue */
    --muted: #0a2a4a;
    --muted-foreground: #00f0ff;
    /* Neon text only for muted labels/icons */
    --accent: #fcee0a;
    /* Selection/Active */
    --accent-foreground: #000000;
    --destructive: #ff003c;
    /* Neon Red */
    --destructive-foreground: #ffffff;
    --border: #00f0ff;
    /* Neon Borders */
    --input: #051628;
    --ring: #fcee0a;
    --radius: 0px;
    /* Sharp edges */
    --shadow: 0 0 10px rgba(252, 238, 10, 0.3), 0 0 5px rgba(0, 240, 255, 0.2);
    /* Neon Glow */

    /* Markdown emphasis colors */
    --md-body-color-default: #e2f2ff;
    --md-bold-color-default: #ffffff;
    --md-italic-color-default: #7dd3fc;
    --md-quote-color-default: #22d3ee;
    --md-quote-border-default: #0e7490;

    --md-body-color: #e2f2ff;
    --md-bold-color: #ffffff;
    --md-italic-color: #7dd3fc;
    --md-quote-color: #22d3ee;
    --md-quote-border: #0e7490;

    --bg-primary: var(--background);
    --text-primary: var(--foreground);
    --text-secondary: var(--muted-foreground);
    --border-color: var(--border);
    --accent-primary: var(--primary);
    --accent-secondary: var(--primary);
    --bg-secondary: var(--card);
    --bg-tertiary: var(--muted);
  }

  /* Claude Theme - Light Mode (Actual claude.ai colors) */
  [data-theme="claude"] {
    --background: #FAF9F5;
    /* Warm cream - actual body background */
    --foreground: #141413;
    /* Near-black text */
    --card: #FFFFFF;
    /* Pure white for cards */
    --card-foreground: #141413;
    --popover: #FFFFFF;
    --popover-foreground: #141413;

    --primary: #CC785C;
    /* Claude's coral/salmon orange - the actual brand color */
    --primary-foreground: #FFFFFF;

    /* User Bubble */
    --secondary: #F0EEE6;
    /* Light beige - actual user message background */
    --secondary-foreground: #141413;
    /* Dark text for contrast */

    /* Bot Bubble - Claude's responses appear on the background */
    --muted: #FAF9F5;
    /* Same as background - Claude's messages don't have a bubble */
    --muted-foreground: #141413;

    --accent: #F0EEE6;
    /* Light surface color */
    --accent-foreground: #141413;
    --destructive: #DC2626;
    /* Red for destructive actions */
    --destructive-foreground: #FFFFFF;
    --border: #1F1E1D;
    /* Dark subtle border from input */
    --input: #FFFFFF;
    /* White input background */
    --ring: #CC785C;
    /* Match primary */
    --radius: 1.5rem;
    /* Claude uses quite round corners */
    --shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
    /* Very subtle shadow */

    --primary-gradient: linear-gradient(135deg, #D68977, #CC785C);

    /* Markdown emphasis colors */
    --md-body-color-default: #141413;
    --md-bold-color-default: #111111;
    --md-italic-color-default: #6b7280;
    --md-quote-color-default: #b45309;
    --md-quote-border-default: #d6d3d1;

    --md-body-color: #141413;
    --md-bold-color: #111111;
    --md-italic-color: #6b7280;
    --md-quote-color: #b45309;
    --md-quote-border: #d6d3d1;

    /* Chess UI - Claude tuning */
    --chess-board-light: #f7e8d4;
    --chess-board-dark: #c78958;
    --chess-panel-bg: #fffdf8;
    --chess-panel-border: rgba(31, 30, 29, 0.18);
    --chess-panel-shadow: 0 14px 26px rgba(31, 30, 29, 0.12);
    --chess-eval-track: rgba(31, 30, 29, 0.12);
    --chess-eval-dark: rgba(31, 30, 29, 0.32);

    --bg-primary: var(--background);
    --text-primary: var(--foreground);
    --text-secondary: var(--muted-foreground);
    --border-color: var(--border);
    --accent-primary: var(--primary);
    --accent-secondary: var(--primary);
    --bg-secondary: var(--card);
    --bg-tertiary: var(--muted);
  }

  /* Prevent browser autofill from forcing light backgrounds in themed inputs */
  input.bg-background:-webkit-autofill,
  input.bg-background:-webkit-autofill:hover,
  input.bg-background:-webkit-autofill:focus,
  textarea.bg-background:-webkit-autofill,
  textarea.bg-background:-webkit-autofill:hover,
  textarea.bg-background:-webkit-autofill:focus {
    -webkit-text-fill-color: var(--foreground);
    -webkit-box-shadow: 0 0 0 1000px var(--background) inset;
    box-shadow: 0 0 0 1000px var(--background) inset;
    caret-color: var(--foreground);
  }

  /* MARKDOWN COLOR OVERRIDES - CRITICAL FIX */
  /* Force prose to use the container's text color (which we successfully set to white/contrast) */
  /* This overrides the default grey text from @tailwindcss/typography */
  .message-bubble .prose:not(.chat-prose),
  .message-bubble .prose:not(.chat-prose) * {
    color: inherit;
  }

  .chat-prose,
  .chat-prose * {
    color: inherit;
  }

  /* Ensure links and code blocks still look distinct if needed, or inherit */
  .message-bubble .prose a,
  .chat-prose a {
    color: inherit;
    text-decoration: underline;
  }

  .message-bubble .prose strong,
  .chat-prose strong {
    color: var(--md-bold-color);
    font-weight: 700;
  }

  .message-bubble .prose em,
  .chat-prose em {
    color: var(--md-italic-color);
    font-style: italic;
  }

  .message-bubble .prose em.dialogue-quote,
  .chat-prose em.dialogue-quote {
    color: var(--md-quote-color);
    font-weight: 500;
    font-style: normal;
  }

  .message-bubble .prose blockquote,
  .chat-prose blockquote {
    color: var(--md-quote-color);
    border-left: 3px solid var(--md-quote-border);
    padding-left: 0.75rem;
  }

  .message-bubble .prose blockquote *,
  .chat-prose blockquote * {
    color: var(--md-quote-color);
  }

  .chat-prose p {
    margin-bottom: 0.75rem;
    white-space: pre-line;
    color: var(--md-body-color, inherit);
  }

  .chat-prose p:last-child {
    margin-bottom: 0;
  }

  .chat-prose ul,
  .chat-prose ol {
    margin: 0.5rem 0 0.75rem 1.25rem;
  }

  .chat-prose li {
    margin-bottom: 0.25rem;
  }

  .chat-prose {
    color: var(--md-body-color, inherit);
    --tw-prose-body: var(--md-body-color, inherit);
    --tw-prose-lead: var(--md-body-color, inherit);
    --tw-prose-bullets: var(--md-body-color, inherit);
    --tw-prose-counters: var(--md-body-color, inherit);
    --tw-prose-invert-body: var(--md-body-color, inherit);
    --tw-prose-invert-lead: var(--md-body-color, inherit);
    --tw-prose-invert-bullets: var(--md-body-color, inherit);
    --tw-prose-invert-counters: var(--md-body-color, inherit);
  }

  .chat-prose h1 {
    color: var(--md-h1-color);
    font-family: var(--md-h1-font);
    font-size: 1.5em;
    font-weight: 700;
    margin: 0.6em 0 0.4em;
  }

  .chat-prose h2 {
    color: var(--md-h2-color);
    font-family: var(--md-h2-font);
    font-size: 1.3em;
    font-weight: 600;
    margin: 0.5em 0 0.35em;
  }

  .chat-prose h3 {
    color: var(--md-h3-color);
    font-family: var(--md-h3-font);
    font-size: 1.1em;
    font-weight: 600;
    margin: 0.4em 0 0.3em;
  }

  .message-bubble .prose code,
  .chat-prose code {
    color: inherit;
    background-color: rgba(0, 0, 0, 0.2);
    /* Slight dim for code bg inside colored bubbles */
  }

  /* Specific handling for user/bot bubbles if needed */
  [data-theme="messenger"] .message-user .prose,
  [data-theme="whatsapp"] .message-user .prose,
  [data-theme="dark"] .message-user .prose,
  [data-theme="claude"] .message-user .prose {
    --tw-prose-body: #ffffff;
    --tw-prose-headings: #ffffff;
    --tw-prose-bold: #ffffff;
    color: #ffffff !important;
  }

  * {
    @apply border-border;
  }

  body {
    @apply bg-background text-foreground;
    font-feature-settings: "rlig" 1, "calt" 1;
    transition: background-color 0.3s ease, color 0.3s ease;
    /* Smooth theming */
  }
}

/* Chess tab styling */
.chess-tab {
  --chess-panel-radius: calc(var(--radius) * 0.75);
}

.chess-toolbar {
  background: var(--chess-panel-bg);
  border: 1px solid var(--chess-panel-border);
  border-radius: var(--radius);
  padding: 0.75rem 1rem;
  box-shadow: var(--chess-panel-shadow);
}

.chess-board-frame {
  width: var(--chess-board-size);
  max-width: 100%;
  border-radius: calc(var(--radius) * 0.6);
  box-shadow: var(--chess-panel-shadow);
  outline: 1px solid var(--chess-panel-border);
  overflow: hidden;
  background: var(--chess-panel-bg);
}

.chess-eval-track {
  width: 0.75rem;
  height: var(--chess-board-size);
  background: var(--chess-eval-track);
  border-radius: 999px;
  overflow: hidden;
  box-shadow: inset 0 0 0 1px var(--chess-panel-border);
  display: flex;
  flex-direction: column;
}

.chess-eval-segment {
  width: 100%;
}

.chess-eval-segment--white {
  background: var(--chess-eval-light);
}

.chess-eval-segment--black {
  background: var(--chess-eval-dark);
}

.chess-eval-label {
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  font-size: 0.6rem;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: var(--muted-foreground);
  font-weight: 600;
}

.chess-eval-label-top {
  top: -1.1rem;
}

.chess-eval-label-bottom {
  bottom: -1.1rem;
}

.chess-eval-score {
  margin-top: 0.75rem;
  font-size: 0.75rem;
  color: var(--muted-foreground);
  font-weight: 600;
}

.chess-panel {
  background: var(--chess-panel-bg);
  border: 1px solid var(--chess-panel-border);
  border-radius: var(--chess-panel-radius);
  box-shadow: var(--chess-panel-shadow);
}

.chess-panel-title {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.65rem;
  text-transform: uppercase;
  letter-spacing: 0.12em;
  color: var(--foreground);
  font-weight: 600;
}

.chess-panel-title::before {
  content: "";
  width: 0.55rem;
  height: 0.55rem;
  border-radius: 999px;
  background: var(--primary);
  box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.08);
}

/* Custom scrollbar - now using variables if needed, or keeping standard muted look */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: var(--muted);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background-color: var(--muted-foreground);
  opacity: 0.3;
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  opacity: 0.5;
}

/* Message styling - now relying on tokens implicitly for colors */
.message-user {
  /* No overrides needed if we use secondary/primary correctly in component */
}

.message-assistant {
  /* No overrides needed */
}

/* Code highlighting */
pre {
  overflow-x: auto;
  padding: 1rem;
  border-radius: 0.5rem;
  margin: 1rem 0;
  border: 1px solid var(--border);
  /* Ensure border visibility */
}

code {
  font-family: "JetBrains Mono", monospace;
  font-size: 0.9em;
}

/* Animation for streaming text */
@keyframes blinking-cursor {
  0% {
    opacity: 0;
  }

  50% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
}

.blinking-cursor::after {
  content: "|";
  animation: blinking-cursor 1s infinite;
  font-weight: normal;
  display: inline-block;
  margin-left: 2px;
  color: var(--primary);
  /* Theme aware cursor */
}

/* Toast notifications */
.toast-container {
  position: fixed;
  bottom: 1rem;
  right: 1rem;
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  z-index: 50;
}

.toast {
  padding: 1rem;
  border-radius: var(--radius);
  background-color: var(--popover);
  color: var(--popover-foreground);
  box-shadow: var(--shadow);
  border: 1px solid var(--border);
  display: flex;
  align-items: center;
  gap: 0.5rem;
  transition: all 0.2s ease-in-out;
  max-width: 24rem;
}

.toast-success {
  border-left: 4px solid #22c55e;
}

.toast-error {
  border-left: 4px solid var(--destructive);
}

.toast-info {
  border-left: 4px solid #3b82f6;
}

.toast-warning {
  border-left: 4px solid #eab308;
}
